<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2019-08-29" />

<title>MCMC Settings</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">MCMC Settings</h1>
<h4 class="date">2019-08-29</h4>


<div id="TOC">
<ul>
<li><a href="#mcmc-related-parameters-in-jointai">MCMC related parameters in <strong>JointAI</strong></a></li>
<li><a href="#chains-and-iterations">Chains and Iterations</a><ul>
<li><a href="#number-of-chains">Number of chains</a></li>
<li><a href="#adaptive-phase">Adaptive phase</a></li>
<li><a href="#sampling-iterations">Sampling iterations</a><ul>
<li><a href="#side-note-how-to-evaluate-convergence">Side note: How to evaluate convergence?</a></li>
<li><a href="#side-note-how-to-check-precision">Side note: How to check precision?</a></li>
</ul></li>
<li><a href="#thinning">Thinning</a></li>
<li><a href="#examples">Examples</a><ul>
<li><a href="#default-settings">Default settings</a></li>
<li><a href="#insufficient-adaptation-phase">Insufficient adaptation phase</a></li>
<li><a href="#thinning-1">Thinning</a></li>
</ul></li>
</ul></li>
<li><a href="#parameters-to-follow">Parameters to follow</a><ul>
<li><a href="#what-are-nodes">What are nodes?</a></li>
<li><a href="#specifying-which-nodes-should-be-monitored">Specifying which nodes should be monitored</a></li>
</ul></li>
<li><a href="#initial-values">Initial values</a><ul>
<li><a href="#user-specified-initial-values">User-specified initial values</a><ul>
<li><a href="#initial-values-in-a-list-of-lists">Initial values in a list of lists</a></li>
<li><a href="#initial-values-as-a-function">Initial values as a function</a></li>
</ul></li>
<li><a href="#for-which-nodes-can-initial-values-be-specified">For which nodes can initial values be specified?</a></li>
</ul></li>
<li><a href="#parallel-sampling">Parallel sampling</a></li>
<li><a href="#other-arguments">Other arguments</a></li>
</ul>
</div>

<p>In <strong>JointAI</strong>, models are estimated in the Bayesian framework, using MCMC (<a href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo">Markov Chain Monte Carlo</a>) sampling. The sampling is done by the software <a href="http://mcmc-jags.sourceforge.net/">JAGS</a> (“Just Another Gibbs Sampler”), which performs <a href="https://en.wikipedia.org/wiki/Gibbs_sampling">Gibbs</a> sampling. <strong>JointAI</strong> pre-processes the data to get it into a form that can be passed to JAGS and writes the JAGS model. The R package <a href="https://CRAN.R-project.org/package=rjags"><strong>rjags</strong></a> is used as an interface to JAGS.</p>
<p>Here, we describe how to specify the arguments in the main functions that control MCMC related settings. To learn more about how to specify the other arguments in <strong>JointAI</strong> models or the theoretical background of the statistical approach, check out the vignettes <a href="https://nerler.github.io/JointAI/articles/ModelSpecification.html"><em>Model Specification</em></a> and <a href="https://nerler.github.io/JointAI/articles/TheoreticalBackground.html"><em>TheoreticalBackground</em></a>.</p>
<p>In this vignette, we use the <a href="https://nerler.github.io/JointAI/reference/NHANES.html">NHANES</a> data for examples in cross-sectional data and the dataset <a href="https://nerler.github.io/JointAI/reference/simLong.html">simLong</a> for examples in longitudinal data. For more info on these datasets, check out the vignette <a href="https://nerler.github.io/JointAI/articles/VisualizingIncompleteData.html"><em>Visualizing Incomplete Data</em></a>, in which the distributions of variables and missing values in both sets is explored.</p>
<p><strong>Note:</strong><br> In several examples we use <code>progress.bar = &#39;none&#39;</code> which prevents printing of the progress of the MCMC sampling, since this would result in lengthy output in the vignette.</p>
<div id="mcmc-related-parameters-in-jointai" class="section level2">
<h2>MCMC related parameters in <strong>JointAI</strong></h2>
<p>The main functions <a href="https://nerler.github.io/JointAI/reference/model_imp.html"><code>*_imp()</code></a> have a number of arguments that specify settings for the MCMC sampling:</p>
<ul>
<li><code>n.chains</code>: number of MCMC chains</li>
<li><code>n.adapt</code>: number of iterations in the adaptive phase</li>
<li><code>n.iter</code>: number of iterations in the sampling phase</li>
<li><code>thin</code>: thinning degree</li>
<li><code>monitor_params</code>: parameters/nodes to be monitored</li>
<li><code>seed</code>: optional seed value for reproducibility</li>
<li><code>inits</code>: initial values</li>
<li><code>parallel</code>: whether the MCMC chains should be sampled in parallel</li>
<li><code>n.cores</code>: how many cores are used for parallel sampling</li>
</ul>
<p>And some other parameters passed to functions from <strong>rjags</strong>:</p>
<ul>
<li><code>quiet</code>: should printing of information be suppressed?</li>
<li><code>progress.bar</code>: type of progress bar</li>
</ul>
</div>
<div id="chains-and-iterations" class="section level2">
<h2>Chains and Iterations</h2>
<p>In MCMC sampling, values are drawn from a probability distribution. The distribution of the current value is drawn from depends on the previously drawn value (but not on values before that). Values, thus, form a chain. Once the chain has converged, its elements can be seen as a sample from the target posterior distribution.</p>
<div id="number-of-chains" class="section level3">
<h3>Number of chains</h3>
<p>To evaluate the convergence of MCMC chains it is helpful to create multiple chains that have different starting values. The argument <code>n.chains</code> selects the number of chains (by default, <code>n.chains = 3</code>).</p>
<p>For calculating the model summary, multiple chains are merged.</p>
</div>
<div id="adaptive-phase" class="section level3">
<h3>Adaptive phase</h3>
<p>JAGS has an adaptive mode, in which samplers are optimized (for example the step size is adjusted). Samples obtained during the adaptive mode do not form a Markov chain and are discarded. The argument <code>n.adapt</code> controls the length of this adaptive phase.</p>
<p>The default value for <code>n.adapt</code> is 100, which works well in many of the examples considered here. Complex models may require longer adaptive phases. If the adaptive phase is not sufficient for JAGS to optimize the samplers, a warning message will be printed (see example below).</p>
</div>
<div id="sampling-iterations" class="section level3">
<h3>Sampling iterations</h3>
<p><code>n.iter</code> specifies the number of iterations in the sampling phase, i.e., the length of the MCMC chain. How many samples are required to reach convergence and to have sufficient precision depends on the complexity of data and model, and may range from as few as 100 to several million.</p>
<div id="side-note-how-to-evaluate-convergence" class="section level4">
<h4>Side note: How to evaluate convergence?</h4>
<p>Convergence can, for instance, be evaluated visually using a <a href="https://nerler.github.io/JointAI/reference/traceplot.html"><code>traceplot()</code></a> or using the Gelman-Rubin diagnostic criterion<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> (implemented in <a href="https://nerler.github.io/JointAI/reference/GR_crit.html"><code>GR_crit()</code></a>, but also returned with the model summary). The latter compares within and between chain variability and requires the JointAI object to have at least two chains.</p>
</div>
<div id="side-note-how-to-check-precision" class="section level4">
<h4>Side note: How to check precision?</h4>
<p>The precision of the MCMC sample can be checked with the function <a href="https://nerler.github.io/JointAI/reference/MC_error.html"><code>MC_error()</code></a>. It calculates the Monte Carlo error (the error that is made since the sample is finite) and compares it to the standard deviation of the posterior sample. A rule of thumb is that the Monte Carlo error should not be more than 5% of the standard deviation.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
</div>
</div>
<div id="thinning" class="section level3">
<h3>Thinning</h3>
<p>In settings with high autocorrelation, i.e., there are no large jumps in the chain but sampled values are always close to the previous value, it may take many iterations before a sample is created that sufficiently represents the whole range of the posterior distribution.</p>
<p>Processing of such long chains can be slow and take a lot of memory. The parameter <code>thin</code> allows the user to specify if and how much the MCMC chains should be thinned out before storing them. By default <code>thin = 1</code> is used, which corresponds to keeping all values. A value <code>thin = 10</code> would result in keeping every 10th value and discarding all other values.</p>
</div>
<div id="examples" class="section level3">
<h3>Examples</h3>
<div id="default-settings" class="section level4">
<h4>Default settings</h4>
<p><code>n.adapt = 100</code> and <code>thin = 1</code> with 100 sampling iterations</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>mod1 &lt;-<span class="st"> </span><span class="kw">lm_imp</span>(SBP <span class="op">~</span><span class="st"> </span>alc, <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">100</span>, <span class="dt">progress.bar =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
<p>The relevant part of the model summary (obtained with <a href="https://nerler.github.io/JointAI/reference/summary.JointAI.html"><code>summary()</code></a>) shows that the first 100 iterations (adaptive phase) were discarded, and the 100 iterations that follow form the posterior sample. Thinning was set to 1 and there are 3 chains.</p>
<pre><code>#&gt; [...]
#&gt; MCMC settings:
#&gt; Iterations = 101:200
#&gt; Sample size per chain = 100 
#&gt; Thinning interval = 1 
#&gt; Number of chains = 3</code></pre>
</div>
<div id="insufficient-adaptation-phase" class="section level4">
<h4>Insufficient adaptation phase</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mod2 &lt;-<span class="st"> </span><span class="kw">lm_imp</span>(SBP <span class="op">~</span><span class="st"> </span>alc, <span class="dt">data =</span> NHANES, <span class="dt">n.adapt =</span> <span class="dv">10</span>, <span class="dt">n.iter =</span> <span class="dv">100</span>, <span class="dt">progress.bar =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt; Warning in rjags::jags.model(file = modelfile, data = data_list, inits = inits, : Adaptation</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; incomplete</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: Stopping adaptation</span></span></code></pre></div>
<p>Specifying <code>n.adapt = 10</code> results in a warning message. The relevant part of the model summary from the resulting model is:</p>
<pre><code>#&gt; [...]
#&gt; MCMC settings:
#&gt; Iterations = 11:110
#&gt; Sample size per chain = 100 
#&gt; Thinning interval = 1 
#&gt; Number of chains = 3</code></pre>
</div>
<div id="thinning-1" class="section level4">
<h4>Thinning</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>mod3 &lt;-<span class="st"> </span><span class="kw">lm_imp</span>(SBP <span class="op">~</span><span class="st"> </span>alc, <span class="dt">data =</span> NHANES, <span class="dt">n.iter =</span> <span class="dv">500</span>, <span class="dt">thin =</span> <span class="dv">10</span>, <span class="dt">progress.bar =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
<p>Here, iterations 110 until 600 are used in the output, but due to thinning interval of ten, the resulting MCMC chains contain only 50 samples instead of 500, that is, the samples from iteration 110, 120, 130, …</p>
<pre><code>#&gt; [...]
#&gt; MCMC settings:
#&gt; Iterations = 110:600
#&gt; Sample size per chain = 50 
#&gt; Thinning interval = 10 
#&gt; Number of chains = 3</code></pre>
</div>
</div>
</div>
<div id="parameters-to-follow" class="section level2">
<h2>Parameters to follow</h2>
<p>JAGS only saves the values of MCMC chains for those nodes for which the user has specified that they should be monitored. This is also the case in <strong>JointAI</strong>.</p>
<div id="what-are-nodes" class="section level3">
<h3>What are nodes?</h3>
<p>Nodes are variables in the Bayesian framework, i.e., everything observed or unobserved. This includes the data and parameters that are estimated, but also missing values in the data or parts of the data that are generally unobserved, such as random effects or latent class indicators.</p>
</div>
<div id="specifying-which-nodes-should-be-monitored" class="section level3">
<h3>Specifying which nodes should be monitored</h3>
<p>For this purpose, the main analysis functions <code>*_imp</code> have an argument <code>monitor_params</code>.</p>
<p>For details, explanation and examples see the vignette <a href="https://nerler.github.io/JointAI/articles/SelectingParameters.html"><em>Parameter Selection</em></a>.</p>
</div>
</div>
<div id="initial-values" class="section level2">
<h2>Initial values</h2>
<p>Initial values are the starting point for the MCMC sampler. Setting good initial values, i.e., initial values that are likely under the posterior distribution, can speed up convergence. By default, the argument <code>inits = NULL</code>, which means that initial values for the nodes are generated by JAGS. <strong>JointAI</strong> only sets the initial values for the random number generators to allow reproducibility of the results.</p>
<p>The argument <code>seed</code> allows the specification of a seed value with which the starting values of the random number generator can be reproduced.</p>
<div id="user-specified-initial-values" class="section level3">
<h3>User-specified initial values</h3>
<p>It is possible to supply initial values directly as</p>
<ul>
<li>a list or</li>
<li>a function.</li>
</ul>
<p>Initial values can be specified for every unobserved node, that is, parameters and missing values, but it is possible to only specify initial values for a subset of nodes.</p>
<p>Unless the user-specified initial values contain initial values for the random number generator (named <code>.RNG.name</code> and <code>.RNG.seed</code>), <strong>JointAI</strong> will add these to the initial values. This is necessary for reproducibility of the results but also when the MCMC chains are sampled in parallel (i.e, when the argument <code>parallel = TRUE</code>).</p>
<div id="initial-values-in-a-list-of-lists" class="section level4">
<h4>Initial values in a list of lists</h4>
<p>A list containing initial values should have the same length as the number of chains, where each element is a named list of initial values. Initial values should differ between the chains.</p>
<p>For example, to create initial values for the parameter vector <code>beta</code> and the precision parameter <code>tau_SBP</code> for three chains:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>init_list &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="cf">function</span>(i) {</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="kw">list</span>(<span class="dt">beta =</span> <span class="kw">rnorm</span>(<span class="dv">4</span>), </span>
<span id="cb7-3"><a href="#cb7-3"></a>       <span class="dt">tau_SBP =</span> <span class="kw">rgamma</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb7-4"><a href="#cb7-4"></a>})</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a>init_list</span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt; [[1]]$beta</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt; [1]  0.4194091 -0.2709566 -0.6318248 -0.2284119</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt; </span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt; [[1]]$tau_SBP</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt; [1] 1.680774</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt; </span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt; </span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#&gt; [[2]]$beta</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">#&gt; [1] -0.2662727  0.5281408 -1.7686592 -0.4897908</span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#&gt; </span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#&gt; [[2]]$tau_SBP</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#&gt; [1] 1.994782</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#&gt; </span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">#&gt; </span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">#&gt; [[3]]$beta</span></span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="co">#&gt; [1] -1.0752636  0.2923947 -0.2066645 -0.3594423</span></span>
<span id="cb7-26"><a href="#cb7-26"></a><span class="co">#&gt; </span></span>
<span id="cb7-27"><a href="#cb7-27"></a><span class="co">#&gt; [[3]]$tau_SBP</span></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="co">#&gt; [1] 1.677375</span></span></code></pre></div>
<p>The list is then passed to the argument <code>inits</code>. The amended version of the user provided lists of initial values are stored in the JointAI object:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>mod4a &lt;-<span class="st"> </span><span class="kw">lm_imp</span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>WC, <span class="dt">data =</span> NHANES, <span class="dt">progress.bar =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb8-2"><a href="#cb8-2"></a>                <span class="dt">inits =</span> init_list)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a>mod4a<span class="op">$</span>mcmc_settings<span class="op">$</span>inits</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; [[1]]$beta</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; [1]  0.4194091 -0.2709566 -0.6318248 -0.2284119</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; </span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; [[1]]$tau_SBP</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; [1] 1.680774</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt; </span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt; [[1]]$.RNG.name</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt; [1] &quot;base::Mersenne-Twister&quot;</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt; </span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt; [[1]]$.RNG.seed</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt; [1] 15419</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt; </span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">#&gt; </span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#&gt; [[2]]$beta</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">#&gt; [1] -0.2662727  0.5281408 -1.7686592 -0.4897908</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt; </span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt; [[2]]$tau_SBP</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">#&gt; [1] 1.994782</span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">#&gt; </span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#&gt; [[2]]$.RNG.name</span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#&gt; [1] &quot;base::Wichmann-Hill&quot;</span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#&gt; </span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">#&gt; [[2]]$.RNG.seed</span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">#&gt; [1] 79827</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">#&gt; </span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co">#&gt; </span></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">#&gt; [[3]]$beta</span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co">#&gt; [1] -1.0752636  0.2923947 -0.2066645 -0.3594423</span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co">#&gt; </span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co">#&gt; [[3]]$tau_SBP</span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co">#&gt; [1] 1.677375</span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="co">#&gt; </span></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co">#&gt; [[3]]$.RNG.name</span></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="co">#&gt; [1] &quot;base::Wichmann-Hill&quot;</span></span>
<span id="cb8-42"><a href="#cb8-42"></a><span class="co">#&gt; </span></span>
<span id="cb8-43"><a href="#cb8-43"></a><span class="co">#&gt; [[3]]$.RNG.seed</span></span>
<span id="cb8-44"><a href="#cb8-44"></a><span class="co">#&gt; [1] 83115</span></span></code></pre></div>
</div>
<div id="initial-values-as-a-function" class="section level4">
<h4>Initial values as a function</h4>
<p>Initial values can be specified by a function. The function should either take no arguments or a single argument called <code>chain</code>, and return a named list that supplies values for one chain.</p>
<p>For example, to create initial values for the parameter vectors <code>beta</code> and <code>alpha</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>inits_fun &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="kw">list</span>(<span class="dt">beta =</span> <span class="kw">rnorm</span>(<span class="dv">4</span>),</span>
<span id="cb9-3"><a href="#cb9-3"></a>       <span class="dt">alpha =</span> <span class="kw">rnorm</span>(<span class="dv">3</span>))</span>
<span id="cb9-4"><a href="#cb9-4"></a>}</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw">inits_fun</span>()</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; $beta</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; [1] -0.5874427 -0.5274437  0.5960212 -1.2713124</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; $alpha</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; [1] -0.2012545  0.4556339 -0.9348269</span></span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a>mod4b &lt;-<span class="st"> </span><span class="kw">lm_imp</span>(SBP <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>WC, <span class="dt">data =</span> NHANES, <span class="dt">progress.bar =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb9-15"><a href="#cb9-15"></a>                <span class="dt">inits =</span> inits_fun)</span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a>mod4b<span class="op">$</span>mcmc_settings<span class="op">$</span>inits</span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt; [[1]]$beta</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt; [1] -0.6377097  0.8351830  0.5890226  0.1700938</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">#&gt; </span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">#&gt; [[1]]$alpha</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt; [1] -0.43717159 -0.08020806 -0.92754276</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt; </span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#&gt; [[1]]$.RNG.name</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">#&gt; [1] &quot;base::Wichmann-Hill&quot;</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">#&gt; </span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co">#&gt; [[1]]$.RNG.seed</span></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co">#&gt; [1] 31227</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co">#&gt; </span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="co">#&gt; </span></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="co">#&gt; [[2]]$beta</span></span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="co">#&gt; [1]  1.51886715  0.08573045  2.15279476 -1.36593150</span></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="co">#&gt; </span></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="co">#&gt; [[2]]$alpha</span></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="co">#&gt; [1]  0.345906225  0.565180699 -0.006097837</span></span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="co">#&gt; </span></span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="co">#&gt; [[2]]$.RNG.name</span></span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="co">#&gt; [1] &quot;base::Mersenne-Twister&quot;</span></span>
<span id="cb9-41"><a href="#cb9-41"></a><span class="co">#&gt; </span></span>
<span id="cb9-42"><a href="#cb9-42"></a><span class="co">#&gt; [[2]]$.RNG.seed</span></span>
<span id="cb9-43"><a href="#cb9-43"></a><span class="co">#&gt; [1] 29634</span></span>
<span id="cb9-44"><a href="#cb9-44"></a><span class="co">#&gt; </span></span>
<span id="cb9-45"><a href="#cb9-45"></a><span class="co">#&gt; </span></span>
<span id="cb9-46"><a href="#cb9-46"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb9-47"><a href="#cb9-47"></a><span class="co">#&gt; [[3]]$beta</span></span>
<span id="cb9-48"><a href="#cb9-48"></a><span class="co">#&gt; [1] -0.4387811  0.6888911 -0.4994192 -1.8686146</span></span>
<span id="cb9-49"><a href="#cb9-49"></a><span class="co">#&gt; </span></span>
<span id="cb9-50"><a href="#cb9-50"></a><span class="co">#&gt; [[3]]$alpha</span></span>
<span id="cb9-51"><a href="#cb9-51"></a><span class="co">#&gt; [1]  0.74342539 -0.08917493  1.08116368</span></span>
<span id="cb9-52"><a href="#cb9-52"></a><span class="co">#&gt; </span></span>
<span id="cb9-53"><a href="#cb9-53"></a><span class="co">#&gt; [[3]]$.RNG.name</span></span>
<span id="cb9-54"><a href="#cb9-54"></a><span class="co">#&gt; [1] &quot;base::Mersenne-Twister&quot;</span></span>
<span id="cb9-55"><a href="#cb9-55"></a><span class="co">#&gt; </span></span>
<span id="cb9-56"><a href="#cb9-56"></a><span class="co">#&gt; [[3]]$.RNG.seed</span></span>
<span id="cb9-57"><a href="#cb9-57"></a><span class="co">#&gt; [1] 53420</span></span></code></pre></div>
<p>When a function is supplied, the function will be evaluated once per chain and the resulting list is stored.</p>
</div>
</div>
<div id="for-which-nodes-can-initial-values-be-specified" class="section level3">
<h3>For which nodes can initial values be specified?</h3>
<p>Initial values can be specified for all unobserved stochastic nodes, i.e., parameters or unobserved data for which a distribution is specified in the JAGS model.</p>
<p>Initial values have to be supplied in the format the parameter or unobserved value is used in the JAGS model.</p>
<p>To find out which nodes there are in a model, the function <code>coef()</code> from package <strong>rjags</strong> can be used on a JAGS model object. It returns a list with the current values of the MCMC chains, by default the first chain. Elements of the initial values should have the same structure as the elements in this list.</p>
<p><strong>Example:<br></strong> We are using a longitudinal model and the <code>simLong</code> data in this example. The output is abbreviated to show the relevant characteristics.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>mod4c &lt;-<span class="st"> </span><span class="kw">lme_imp</span>(bmi <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>HEIGHT_M <span class="op">+</span><span class="st"> </span>hc <span class="op">+</span><span class="st"> </span>SMOKE, <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span>time <span class="op">|</span><span class="st"> </span>ID,</span>
<span id="cb10-2"><a href="#cb10-2"></a>                 <span class="dt">data =</span> simLong, <span class="dt">no_model =</span> <span class="st">&#39;time&#39;</span>, <span class="dt">progress.bar =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="kw">coef</span>(mod4c<span class="op">$</span>model)</span></code></pre></div>
<pre><code>#&gt; $RinvD
#&gt;           [,1]      [,2]
#&gt; [1,] 0.7659268        NA
#&gt; [2,]        NA 0.2308901
#&gt; 
#&gt; $RinvD_hc
#&gt;           [,1]         [,2]
#&gt; [1,] 0.0400501           NA
#&gt; [2,]        NA 0.0001842381
#&gt; 
#&gt; $Xc
#&gt;        [,1]       [,2] [,3] [,4]
#&gt;   [1,]   NA         NA   NA   NA
#&gt;   [2,]   NA         NA   NA   NA
#&gt; 
#&gt; [...]
#&gt; 
#&gt;  [82,]   NA         NA   NA   NA
#&gt;  [83,]   NA  0.4091066   NA   NA
#&gt;  [84,]   NA         NA   NA   NA
#&gt; 
#&gt; [...]
#&gt; 
#&gt; [199,]   NA         NA   NA   NA
#&gt; [200,]   NA         NA   NA   NA
#&gt; 
#&gt; $Xcat
#&gt;        [,1]
#&gt;   [1,]   NA
#&gt;   [2,]   NA
#&gt; 
#&gt; [...]
#&gt; 
#&gt; [139,]   NA
#&gt; [140,]    1
#&gt; [141,]   NA
#&gt; [142,]    1
#&gt; [143,]   NA
#&gt; 
#&gt; [...]
#&gt; 
#&gt; [199,]   NA
#&gt; [200,]   NA
#&gt; 
#&gt; $Xl
#&gt;                 [,1]
#&gt;    [1,]           NA
#&gt;    [2,]           NA
#&gt;    [3,]  0.000000000
#&gt;    [4,]           NA
#&gt;    [5,]           NA
#&gt;    [6,]           NA
#&gt;    [7,] -0.214817175
#&gt; 
#&gt; [...]
#&gt; 
#&gt; [2399,]           NA
#&gt; [2400,]           NA
#&gt; 
#&gt; $alpha
#&gt; [1] -0.023398669 -0.011456948  0.050830346  0.002318776 -0.195963349  0.013870602  0.834277915
#&gt; 
#&gt; $b
#&gt;            [,1]       [,2]
#&gt;   [1,] 15.89715 -1.0462718
#&gt;   [2,] 16.92166 -1.4536040
#&gt; 
#&gt; [...]
#&gt; 
#&gt; [200,] 16.98724 -1.3006194
#&gt; 
#&gt; $b_hc
#&gt;                 [,1]      [,2]
#&gt;   [1,] -4.812325e-01 0.8058138
#&gt;   [2,] -3.945752e-02 0.8195184
#&gt; 
#&gt; [...]
#&gt; 
#&gt; [199,] -1.455908e-01 0.8114976
#&gt; [200,] -1.024603e-01 0.8528284
#&gt; 
#&gt; $beta
#&gt; [1] 16.47083724  0.05746001 -0.21654280 -0.09097774 -1.37860072  1.44401948
#&gt; 
#&gt; $bmi
#&gt;    [1] NA NA  0  0 NA NA NA NA NA NA NA NA  0  0 NA  0 NA  0 NA NA NA NA NA NA NA NA NA NA NA NA NA
#&gt; 
#&gt; [...]
#&gt; 
#&gt; [2388] NA NA  0 NA  0 NA NA NA NA NA NA NA NA
#&gt; 
#&gt; $delta_SMOKE
#&gt; [1] -1.185836
#&gt; 
#&gt; $gamma_SMOKE
#&gt; [1] 1.035457       NA
#&gt; 
#&gt; $invD
#&gt;           [,1]      [,2]
#&gt; [1,]  1.563199 -1.320860
#&gt; [2,] -1.320860  8.350886
#&gt; 
#&gt; $invD_hc
#&gt;            [,1]      [,2]
#&gt; [1,]   27.14434 -181.7469
#&gt; [2,] -181.74693 2700.2794
#&gt; 
#&gt; $mu_b
#&gt;        [,1]      [,2]
#&gt;   [1,]   NA -1.378601
#&gt;   [2,]   NA -1.378601
#&gt; 
#&gt; [...]
#&gt; 
#&gt; [199,]   NA -1.378601
#&gt; [200,]   NA -1.378601
#&gt; 
#&gt; $mu_b_hc
#&gt;        [,1]      [,2]
#&gt;   [1,]   NA 0.8342779
#&gt;   [2,]   NA 0.8342779
#&gt; 
#&gt; [...]
#&gt; 
#&gt; [200,]   NA 0.8342779
#&gt; 
#&gt; $tau_HEIGHT_M
#&gt; [1] 1.053073
#&gt; 
#&gt; $tau_bmi
#&gt; [1] 4.897738
#&gt; 
#&gt; $tau_hc
#&gt; [1] 5.353787</code></pre>
<p><code>RinvD</code> is the scale matrix in the Wishart prior for the inverse of the random effects design matrix <code>D</code>. In the data that is passed JAGS (which is stored in the element <code>data_list</code> in a JointAI object), this matrix is specified as diagonal matrix, with unknown diagonal elements:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>mod4c<span class="op">$</span>data_list[<span class="st">&#39;RinvD&#39;</span>]</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt; $RinvD</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; [1,]   NA    0</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt; [2,]    0   NA</span></span></code></pre></div>
<p>These diagonal elements are estimated in the model and have a Gamma prior. The corresponding part of the JAGS model is:</p>
<pre><code>#&gt; [...]
#&gt;   # Priors for the covariance of the random effects
#&gt;   for (k in 1:2){
#&gt;     RinvD[k, k] ~ dgamma(shape_diag_RinvD, rate_diag_RinvD)
#&gt;   }
#&gt;   invD[1:2, 1:2] ~ dwish(RinvD[ , ], KinvD)
#&gt;   D[1:2, 1:2] &lt;- inverse(invD[ , ])
#&gt; [...]</code></pre>
<p>The element <code>RinvD</code> in the initial values has to be a 2 <span class="math inline">\(\times\)</span> 2 matrix, with positive values on the diagonal and <code>NA</code> as off-diagonal elements, since these are fixed in the data.</p>
<p>The following element in the output of <code>coef(mod4c$model)</code> is <code>Xc</code>, the fixed effects design matrix containing baseline covariates. The corresponding matrix in the data is</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>mod4c<span class="op">$</span>data_list<span class="op">$</span>Xc[<span class="dv">81</span><span class="op">:</span><span class="dv">85</span>, ]</span></code></pre></div>
<pre><code>#&gt;       (Intercept)  HEIGHT_M SMOKEsmoked until[...] SMOKEcontin[...]
#&gt; 171.1           1 0.2736946                     NA               NA
#&gt; 172.1           1 0.1148171                     NA               NA
#&gt; 173.1           1        NA                     NA               NA
#&gt; 174.1           1 0.5045126                     NA               NA
#&gt; 175.1           1 1.8822249                     NA               NA</code></pre>
<p>Again, the matrix <code>Xc</code> in the initial values has the same dimension as <code>Xc</code> in the data, and values where there are missing values in <code>Xc</code>, e.g., <code>Xc[83, 2]</code> and <code>NA</code> elsewhere. There are no initial values specified for the third and fourth column, since these columns contain the dummy variables corresponding to the categorical variable <code>SMOKE</code> and are calculated from a column in the matrix <code>Xcat</code>, which contains the original version of <code>SMOKE</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">head</span>(mod4c<span class="op">$</span>data_list<span class="op">$</span>Xcat)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">#&gt;       SMOKE</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt; 1.1       1</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt; 10.1      1</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; 100.1     3</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt; 101.1     1</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt; 102.1     1</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt; 103.1    NA</span></span></code></pre></div>
<p>The relevant part of the JAGS model is:</p>
<pre><code>#&gt; [...]
#&gt;     # ordinal model for SMOKE
#&gt;     Xcat[i, 1] ~ dcat(p_SMOKE[i, 1:3])
#&gt; 
#&gt; [...]
#&gt; 
#&gt;     Xc[i, 3] &lt;- ifelse(Xcat[i, 1] == 2, 1, 0)
#&gt;     Xc[i, 4] &lt;- ifelse(Xcat[i, 1] == 3, 1, 0)
#&gt; [...]</code></pre>
<p>Where <code>Xcat</code> in the data has missing values (e.g., rows 37 and 39), initial values need to be specified.</p>
<p>Elements that are completely unobserved, like the parameter vectors <code>alpha</code> and <code>beta</code>, the random effects <code>b</code> or scalar parameters <code>delta_SMOKE</code> and <code>gamma_SMOKE</code> are entirely specified in the initial values.</p>
</div>
</div>
<div id="parallel-sampling" class="section level2">
<h2>Parallel sampling</h2>
<p>To reduce computational time, it is possible to perform sampling of multiple MCMC chains in parallel on multiple cores. This can be specified by setting the argument <code>parallel = TRUE</code>. The maximum number of cores to be used can be set with the argument <code>n.cores</code>. By default, this is two less than the number of cores available on the machine, but never more than the number of MCMC chains.</p>
<p>Parallel computation is done using the R packages <a href="https://CRAN.R-project.org/package=foreach"><strong>foreach</strong></a> and <a href="https://CRAN.R-project.org/package=doParallel"><strong>doParallel</strong></a>. Unfortunately, currently it is not possible to obtain a progress bar when using parallel computation and warning messages produced during the sampling are not returned.</p>
</div>
<div id="other-arguments" class="section level2">
<h2>Other arguments</h2>
<p>There are two more arguments in <code>*_imp()</code> that are passed directly to the <strong>rjags</strong> functions <code>jags.model()</code> or <code>coda.samples()</code>:</p>
<ul>
<li><code>quiet</code>: should messages generated during compilation be suppressed?</li>
<li><code>progress.bar</code>: allows to select the type of progress bar. Possible values are <code>&quot;text&quot;</code>, <code>&quot;gui&quot;</code> and <code>&quot;none&quot;</code>.</li>
</ul>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p> Gelman, A., Meng, X. L., &amp; Stern, H. (1996). Posterior predictive assessment of model fitness via realized discrepancies. Statistica Sinica, 733-760.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>See p. 195 of Lesaffre, E., &amp; Lawson, A. B. (2012). Bayesian Biostatistics. John Wiley &amp; Sons.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
